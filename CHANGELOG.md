# 更新日志

本文档记录了 AI-CodeNexus 项目的所有重要更新和变更。

---

## v4.0（当前版本）

### 重大更新
- ✅ 全新导航菜单结构
  - 移除：热门资讯、提交资讯
  - 优化：将编程资讯和AI资讯合并为"最新资讯"下拉菜单
  - 新增：提示词、规则、社区资源
  - 聚焦AI编程中最重要的四个核心内容

### 新增功能
- ✅ 提示词模块（Prompts）
  - 精选AI编程相关提示词
  - 支持分类浏览和搜索
  - 参考 waytoagi.com 的编码提示词
  - 支持一键复制提示词内容
  - 优化排版，完整显示提示词内容
  
- ✅ 规则模块（Rules）
  - Cursor Rules 和其他AI编程规则
  - 支持分类浏览和搜索
  - 参考 cursor.directory 的规则格式
  - 从 dotcursorrules.com 扩展规则库，包含31个规则
  
- ✅ 社区资源模块（Resources）
  - AI编程教程、文章和社区资源
  - 支持类型和分类筛选
  - 参考 cursor101.com 的资源内容
  - 按分类模块化显示（飞书知识库、技术社区）

### 修复问题
- ✅ 修复导航菜单激活状态问题
  - 修复菜单项点击后激活状态不更新的问题
  - 优化路由匹配逻辑，支持所有路由正确激活
  - 在内容加载完成后自动更新导航状态
  
- ✅ 修复社区资源加载失败问题
  - 修复 page_size=1000 超过API限制导致的422错误
  - 调整为使用 page_size=100 获取资源
  
- ✅ 修复提示词复制功能语法错误
  - 修复JavaScript正则表达式语法错误
  - 使用base64编码安全传递提示词内容
  - 优化复制功能的用户体验

### 技术实现
- 新增API路由：`/api/prompts`、`/api/rules`、`/api/resources`
- 扩展 DataLoader 服务，支持新数据类型
- 新增前端路由和页面渲染逻辑
- 更新配置文件，添加新页面配置
- 优化导航菜单激活状态管理
- 创建社区资源抓取脚本：`scripts/crawl_devmaster_resources.py`

### 数据文件
- `data/prompts.json` - 提示词数据（包含飞书文档中的提示词）
- `data/rules.json` - 规则数据（31个规则）
- `data/resources.json` - 社区资源数据（按分类组织）

---

## v3.6

### 新增功能
- ✅ 管理员文章删除功能
  - 管理员登录后，前端页面的每个文章右侧显示删除按钮
  - 支持从所有数据源删除文章：
    - 文章池（`ai_articles.json`）
    - 归档分类文件（`ai_news.json`、`programming.json`、`ai_coding.json`）
    - 周报文件（`data/weekly/` 目录下的Markdown文件）
  - 删除后自动更新周报
  - 删除按钮仅在管理员登录后显示（通过暗码登录）
  - 支持在所有文章列表页面删除（分类列表、工具详情页相关文章、热门资讯、最新资讯等）

### 技术实现
- 前端：添加 `isAdmin()` 和 `deleteArticle()` 函数
- 后端：扩展删除API，支持从所有数据源删除
- 数据服务：添加 `delete_article_from_all_categories()` 方法
- 周报服务：添加 `delete_article_from_weekly()` 方法

---

## v3.5

### 移动端优化
- ✅ 全面优化移动端浏览器体验
  - 左侧菜单栏在移动端默认隐藏，可通过汉堡菜单按钮打开/关闭
  - 添加移动端侧边栏抽屉效果，支持滑动显示和遮罩层关闭
  - 顶部导航栏在移动端隐藏，添加下拉菜单按钮（⋮）访问所有导航链接
  - 主内容区域在移动端自动占满屏幕宽度，不再被侧边栏占据空间
  - 优化移动端布局和交互体验，支持触摸操作和键盘快捷键（ESC关闭菜单）
  - 响应式设计，完美适配手机浏览器

---
## v3.4

### 新增功能
- ✅ 添加每周资讯推荐功能
  - 自动整理本周新增的资讯为Markdown格式
  - 当有资讯被采纳或归档时自动更新周报
  - 文件命名格式：`{年份}weekly{周数}.md`
  - 适合复制到微信公众号的格式
  - 随数据备份一起提交到GitHub

---

## v3.3

### 新增功能
- ✅ 添加数据自动备份功能
  - 每天 23:00 自动将 `data/` 和 `config/` 目录提交到 GitHub
  - 自动处理冲突，拉取最新代码后重新推送
  - 智能检测变更，没有变更时跳过提交
  - 详细的日志记录，便于排查问题

- ✅ 添加日志存档功能
  - 自动将日志保存到文件（`logs/` 目录）
  - 按日期自动轮转和压缩
  - 定时任务关键日志单独存档（保留90天）
  - 错误日志单独存档（保留90天）
  - 应用日志存档（保留30天）

---

## v3.2

### 修复问题
- ✅ 修复归档状态检查问题
  - 改进微信文章URL规范化逻辑，避免动态参数导致的误判
  - 对于只有动态参数的URL，使用精确匹配而非规范化匹配
  - 修复关键词摘取和工具关键词摘取的资讯误判为已归档的问题

- ✅ 修复热门工具显示问题
  - 修复热门工具只显示29个工具的问题（实际有113个工具）
  - 热门工具模式不去重，显示所有工具并按访问量排序
  - 其他模式使用URL去重（比ID更可靠）

### 改进功能
- ✅ 改进微信公众号页面
  - 添加GitHub仓库宣传卡片
  - 修复文字对齐问题，GitHub链接和描述文字居中显示
  - 优化页面布局和视觉效果

- ✅ 实现全局浮动按钮功能
  - 反馈/联系按钮：点击跳转到提交资讯页面
  - 回到顶部按钮：滚动超过300px时显示，点击平滑滚动到顶部

---

## v3.1

### 功能增强
- ✅ 自动推送功能增强
  - 文章池和候选池都为空时，自动按关键字抓取文章
  - 每个关键字随机选择1篇文章，直接放入文章列表
  - 推送完成后自动清理文章池和候选池
  - 完善的错误处理和日志记录

- ✅ 推送函数改进
  - 推送函数返回成功/失败状态
  - 详细的日志记录（`[定时推送]`、`[自动抓取]`、`[调度器]`）
  - 统一手动推送和定时推送的逻辑

---

## v3.0

### 新增功能
- ✅ 工具相关资讯获取功能
  - 工具关键字自动管理
  - 手动触发单个或批量获取
  - 自动标签关联
  - 工具详情页展示相关资讯

- ✅ 工具数据录入和整理
  - 完善工具分类体系
  - 工具标识符（identifier）支持
  - 工具详情页功能

---

## v2.0

### 核心功能
- ✅ 完整的资讯和工具聚合平台
- ✅ 用户提交功能
- ✅ 管理员审核功能
- ✅ 点击统计和热度排序
- ✅ 文章-工具关联
- ✅ 现代化UI设计
- ✅ 标准URL路由（无 `#`）

---

## v1.0

### 初始版本
- ✅ 基础的文章抓取和管理系统
- ✅ 多资讯源支持
- ✅ 微信公众号发布

---

**文档维护**：本文档会随着项目更新持续维护，记录所有重要的功能变更和修复。

