# v3.0 版本更新说明

## 更新概述

v3.0 版本主要完成了工具相关资讯获取功能的开发，以及工具数据的录入和整理工作。

## 主要功能更新

### 1. 工具相关资讯获取功能

#### 功能描述
为每个工具提供手动触发相关资讯获取的能力，获取到的资讯会自动关联到对应工具，并在工具详情页展示。

#### 核心特性
- **工具关键字自动管理**
  - 工具被采纳时，自动将工具名称添加到关键字配置
  - 配置文件：`config/tool_keywords.json`
  - 自动去重，避免重复添加

- **手动触发获取**
  - 支持单个工具获取：选择特定工具关键字，每次获取1篇当天的相关资讯
  - 支持批量获取：一次性获取所有工具的相关资讯
  - 只获取当天的资讯内容，确保内容时效性

- **自动标签关联**
  - 获取到的资讯自动带有工具名称标签
  - 归档或采纳资讯时，系统自动从获取来源中提取工具名称作为标签
  - 带有工具标签的资讯会在工具详情页自动展示

- **资讯管理**
  - 获取到的资讯首先进入候选池，等待管理员审核
  - 支持采纳、归档、忽略操作
  - 归档时自动填充工具标签（如果是工具相关资讯）

#### 技术实现

**新增配置文件**：
- `config/tool_keywords.json` - 工具关键字列表（自动管理）

**新增API接口**：
- `GET /digest/tool-keywords` - 获取工具关键字列表
- `POST /digest/crawl-tool-articles` - 获取工具相关资讯
  - Body: `{"keyword": "Cursor"}` - 可选，不提供则获取所有工具

**代码更新**：
- `app/config_loader.py` - 新增工具关键字管理函数
  - `load_tool_keywords()` - 加载工具关键字
  - `save_tool_keywords()` - 保存工具关键字
  - `add_tool_keyword()` - 添加工具关键字

- `app/routes/digest.py` - 新增API接口和管理界面
  - 工具采纳时自动添加关键字
  - 工具相关资讯获取接口
  - 管理员面板新增工具相关资讯获取区域

- `app/sources/ai_articles.py` - 支持保存工具标签
  - `save_article_to_config()` - 支持保存 `tool_tags` 字段

- `app/routes/digest.py` - 归档和采纳逻辑优化
  - 自动从 `crawled_from` 字段提取工具名称
  - 归档对话框自动填充工具标签

### 2. 工具数据录入和整理

#### 完成工作
- 完善工具分类体系
- 录入112个工具数据
- 清空 `other.json` 分类，为后续页面展示做准备
- 初始化工具关键字配置，从所有现有工具中提取名称

#### 数据文件
- `data/tools/` - 各分类工具数据文件
- `config/tool_keywords.json` - 工具关键字配置（112个工具名称）

## 文档更新

### 新增文档
- `docs/feature/tool_article_crawling_feature.md` - 工具相关资讯获取功能详细说明

### 更新文档
- `docs/feature/features_complete.md` - 添加工具相关资讯获取功能说明
- `docs/README.md` - 更新文档目录，添加新文档链接

## 使用说明

### 管理员操作

1. **查看工具关键字**
   - 进入管理员面板 `/digest/panel`
   - 在"文章获取与候选池"部分查看"工具相关资讯获取"区域
   - 查看当前工具关键字数量

2. **获取单个工具资讯**
   - 从下拉列表选择工具关键字
   - 点击"获取该工具资讯"按钮
   - 系统会获取1篇当天的相关资讯并进入候选池

3. **批量获取所有工具资讯**
   - 点击"获取所有工具资讯"按钮
   - 系统会遍历所有工具关键字，每个关键字获取1篇资讯

4. **审核和管理资讯**
   - 在候选池中查看获取到的资讯
   - 归档时，工具标签会自动填充（如果是工具相关资讯）
   - 采纳或归档后，资讯会关联到对应工具

### 工具关键字管理

- **自动添加**：工具被采纳时自动添加，无需手动操作
- **手动更新**：如需批量更新，可以直接编辑 `config/tool_keywords.json`
- **初始化**：系统启动时会从所有现有工具中提取名称并写入配置文件

## 注意事项

1. **获取频率**：建议不要过于频繁地获取，避免对数据源造成压力
2. **内容审核**：所有获取到的资讯都需要管理员审核后才能发布
3. **标签关联**：归档时请确认工具标签是否正确，可以手动修改
4. **当天内容**：系统只获取当天的资讯，确保内容时效性

## 技术细节

### 数据流程

1. **工具采纳** → 自动添加工具名称到关键字配置
2. **手动触发获取** → 使用工具关键字获取相关资讯
3. **资讯进入候选池** → 带有 `tool_keyword:工具名称` 标识
4. **归档/采纳** → 自动提取工具名称作为 `tool_tags`
5. **工具详情页** → 通过 `tool_tags` 匹配显示相关资讯

### 工具与资讯的关联机制

- **工具标签** (`tool_tags`): 资讯归档或采纳时，会自动添加工具名称作为标签
- **工具详情页**：通过匹配资讯的 `tool_tags` 和工具的 `name` 或 `identifier` 来显示相关资讯
- **双向关联**：工具详情页可以查看相关资讯，资讯也可以关联多个工具

## 相关文件

### 配置文件
- `config/tool_keywords.json` - 工具关键字列表

### 代码文件
- `app/config_loader.py` - 工具关键字管理
- `app/routes/digest.py` - API接口和管理界面
- `app/sources/ai_articles.py` - 文章保存逻辑
- `app/services/data_loader.py` - 数据加载和关联查询

### 文档文件
- `docs/feature/tool_article_crawling_feature.md` - 功能详细说明
- `docs/feature/features_complete.md` - 完整功能文档
- `docs/README.md` - 文档目录

## 后续计划

- [ ] 在页面上添加 "others" 分类展示
- [ ] 优化工具关键字管理界面
- [ ] 支持工具关键字的批量编辑和删除

---

**更新日期**：2024年11月  
**版本**：v3.0

