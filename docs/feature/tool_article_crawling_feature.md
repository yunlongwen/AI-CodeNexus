# 工具相关资讯获取功能

## 功能概述

工具相关资讯获取功能允许管理员为每个工具手动触发相关资讯的获取，获取到的资讯会自动关联到对应工具，并在工具详情页展示。

## 核心特性

### 1. 工具关键字自动管理

- **自动添加**：当工具被采纳到正式工具库时，系统会自动将工具名称添加到工具关键字配置中
- **配置文件**：工具关键字存储在 `config/tool_keywords.json`
- **去重处理**：自动避免重复添加相同的工具名称

### 2. 手动触发获取

- **单个工具获取**：管理员可以选择特定工具关键字，每次获取1篇当天的相关资讯
- **批量获取**：支持一次性获取所有工具的相关资讯
- **当天内容**：只获取当天的资讯内容，确保内容时效性

### 3. 自动标签关联

- **工具标签**：获取到的资讯会自动带有工具名称标签
- **自动提取**：归档或采纳资讯时，系统会自动从获取来源中提取工具名称作为标签
- **工具关联**：带有工具标签的资讯会在工具详情页自动展示

### 4. 资讯管理

- **候选池**：获取到的资讯首先进入候选池，等待管理员审核
- **采纳**：采纳后进入正式资讯列表，用于每日推送
- **归档**：归档后进入网站资讯列表（编程资讯或AI资讯），可在前端页面展示
- **忽略**：可以忽略不需要的资讯

## 技术实现

### 配置文件

**工具关键字配置** (`config/tool_keywords.json`):
```json
[
  "Cursor",
  "GitHub-Copilot",
  "V0.dev",
  ...
]
```

### API 接口

#### 1. 获取工具关键字列表
```
GET /digest/tool-keywords
```
返回所有工具关键字及其数量。

#### 2. 获取工具相关资讯
```
POST /digest/crawl-tool-articles
Body: {
  "keyword": "Cursor"  // 可选，不提供则获取所有工具
}
```
- 如果提供 `keyword`，只获取该工具的相关资讯
- 如果不提供，获取所有工具的相关资讯
- 每个工具关键字每次只获取1篇当天的文章

### 数据流程

1. **工具采纳** → 自动添加工具名称到关键字配置
2. **手动触发获取** → 使用工具关键字获取相关资讯
3. **资讯进入候选池** → 带有 `tool_keyword:工具名称` 标识
4. **归档/采纳** → 自动提取工具名称作为 `tool_tags`
5. **工具详情页** → 通过 `tool_tags` 匹配显示相关资讯

### 关键代码位置

- **配置管理**: `app/config_loader.py`
  - `load_tool_keywords()` - 加载工具关键字
  - `save_tool_keywords()` - 保存工具关键字
  - `add_tool_keyword()` - 添加工具关键字

- **API接口**: `app/routes/digest.py`
  - `POST /crawl-tool-articles` - 获取工具相关资讯
  - `GET /tool-keywords` - 获取工具关键字列表
  - `POST /accept-tool-candidate` - 采纳工具时自动添加关键字

- **前端界面**: `app/routes/digest.py` (管理员面板HTML)
  - 工具关键字下拉选择器
  - 单个工具获取按钮
  - 批量获取按钮

## 使用指南

### 管理员操作流程

1. **查看工具关键字**
   - 进入管理员面板
   - 在"文章获取与候选池"部分查看"工具相关资讯获取"区域
   - 查看当前工具关键字数量

2. **获取单个工具资讯**
   - 从下拉列表选择工具关键字
   - 点击"获取该工具资讯"按钮
   - 系统会获取1篇当天的相关资讯

3. **批量获取所有工具资讯**
   - 点击"获取所有工具资讯"按钮
   - 系统会遍历所有工具关键字，每个关键字获取1篇资讯

4. **审核和管理资讯**
   - 在候选池中查看获取到的资讯
   - 归档时，工具标签会自动填充（如果是工具相关资讯）
   - 采纳或归档后，资讯会关联到对应工具

### 工具关键字管理

- **自动添加**：工具被采纳时自动添加，无需手动操作
- **手动更新**：如需批量更新，可以直接编辑 `config/tool_keywords.json`
- **初始化**：系统启动时会从所有现有工具中提取名称并写入配置文件

## 注意事项

1. **获取频率**：建议不要过于频繁地获取，避免对数据源造成压力
2. **内容审核**：所有获取到的资讯都需要管理员审核后才能发布
3. **标签关联**：归档时请确认工具标签是否正确，可以手动修改
4. **当天内容**：系统只获取当天的资讯，确保内容时效性

## 数据关联

### 工具与资讯的关联机制

- **工具标签** (`tool_tags`): 资讯归档或采纳时，会自动添加工具名称作为标签
- **工具详情页**：通过匹配资讯的 `tool_tags` 和工具的 `name` 或 `identifier` 来显示相关资讯
- **双向关联**：工具详情页可以查看相关资讯，资讯也可以关联多个工具

## 更新日志

- **v3.0**: 新增工具相关资讯获取功能
  - 支持工具关键字自动管理
  - 支持手动触发单个或批量获取
  - 支持自动标签关联
  - 支持在工具详情页展示相关资讯

